{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "db3e307c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#libraries\n",
    "\n",
    "import numpy as np\n",
    "from scipy.stats import qmc\n",
    "from scipy.stats import pearsonr\n",
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt\n",
    "from SALib.sample import saltelli\n",
    "from SALib.analyze import sobol \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "c62d1789",
   "metadata": {},
   "outputs": [],
   "source": [
    "def dx(L, am, an):\n",
    "    return 2*L*np.sin((am-an)/4)*np.cos((am+an)/4)\n",
    "\n",
    "def dy(L, am, an):\n",
    "    return 2*L*np.sin((an+am)/4)*np.sin((an-am)/4)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "dd864a34",
   "metadata": {},
   "outputs": [],
   "source": [
    "L_range  = (0.2, 1.0)   # meters\n",
    "am_range = (0.5, 1.5)   # rad\n",
    "an_range = (0.1, 0.8)   # rad\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "cbd1d51a",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "\n",
    "N = 5000\n",
    "sampler = qmc.LatinHypercube(d=3)\n",
    "X = sampler.random(N)\n",
    "\n",
    "L = L_range[0] + X[:,0] * (L_range[1] - L_range[0])\n",
    "am = am_range[0] + X[:,1] * (am_range[1] - am_range[0])\n",
    "an = an_range[0] + X[:,2] * (an_range[1] - an_range[0])\n",
    "\n",
    "DX = dx(L, am, an)\n",
    "DY = dy(L, am, an)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "a688075b",
   "metadata": {},
   "outputs": [],
   "source": [
    "def sensitivity(inputs, output):\n",
    "    S = []\n",
    "    for i in range(inputs.shape[1]):\n",
    "        r, _ = pearsonr(inputs[:,i], output)\n",
    "        S.append(abs(r))\n",
    "    S = np.array(S)\n",
    "    return S / S.sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "cca3d8f1",
   "metadata": {},
   "outputs": [],
   "source": [
    "X_phys = np.column_stack([L, am, an])\n",
    "\n",
    "S_dx = sensitivity(X_phys, DX)\n",
    "S_dy = sensitivity(X_phys, DY)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "0bfc36cd",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "          Δx        Δy\n",
      "L   0.299774  0.296811\n",
      "αm  0.393780  0.528288\n",
      "αn  0.306447  0.174901\n"
     ]
    }
   ],
   "source": [
    "\n",
    "df = pd.DataFrame(\n",
    "    {'Δx': S_dx, 'Δy': S_dy},\n",
    "    index=['L', 'αm', 'αn']\n",
    ")\n",
    "\n",
    "print(df)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "58ddcb50",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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s88CW+biUGMHAABQCm+88Yb069dPUlNTZc+ePVIeEOwAAABK6MSJEzJ//nwZMWKEXHXVVfLmm28W/G7ChAlSt25dOXToUMGynj17mvXy8/PFnwh2AAAAJfTee++ZK0W0a9dObr/9dpk1a5aZbFiNHj1aEhMT5c477zT3Z8yYIatWrZK33npLwsP9G70IdgAAAKVohtVAp3r16iV79+6VFStWmPs6wfA777xjmmhHjRolDz/8sAl355xzjvgbgycAwNcm1RPJPymWMu5YsEsAWMbWrVtNDZyz+bVSpUpy4403mrB35ZVXmmUNGzaUKVOmyF133SV9+/aV/v37B6Rs1NgBAACUgAa4tm3bSuPGjQuWae3dhx9+KMeO/e+PpK+//trU3u3YsUNOnTolgUCwAwAA8JIGtDlz5hSpgevatau5LNjcuXPNfR1YsWDBAlm+fLmkpaXJxIkTJRBoigUAAPDSwoULJT09XZo1ayabNm1y+90VV1xhavOuu+46ueeee2Ty5Mly2WWXyezZs82ya6+9Vi655BLxJ4IdAACAlzS4qS5duhS7zsCBA81o2WHDhpn73bp1M0FvwIABsn79etMnz18IdgAAoFwp7ZUgAuHTTz8t1eOef/55c/M3+tgBAADYBMEOAADAJgh2AAAANkGwAwAAsAmCHQAAgE0Q7AAAAGyCYAcAAGATBDsAAACbINgBAADYBMEOAADAJsrFJcVmzJghzzzzjOzbt09atGghL7zwgrnGmidvvvmmJCUluS2LiYmRkydPBqi0AADAr8ZVCfD+jpXqYatXr5aOHTtKjx495LPPPpPyIOg1dvPnz5eRI0dKSkqKrFu3zgQ7vVju/v37i31M5cqVZe/evQW3P//8M6BlBgAAeOONN6Rfv36Smpoqe/bskfIg6MFu2rRpMnToUFML17RpU5k5c6bExcXJrFmzin1MWFiY1K5du+BWq1atgJYZAACEthMnTpjKqREjRshVV11lWhSVw+GQRo0ayZQpU9zWX79+vckv27dvt29TbE5Ojqxdu1aSk5MLloWHh0vnzp1N9ebpDua5554r+fn50qpVK3nyySflwgsv9Lhudna2uTllZGSY/3Nzc80N/uc8zhxvhMy5Hh4rlsP7EwH+TNfHawjS73K9BbPWKb/Q/r0xb948U7nUpk0bU2s3YcIEefTRR01408qq2bNn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pZf6p0QAAAAIzDx21apVk+rVq5dubwAAACg/wW7ixIkyduxYycrK8k+JAAAAEJim2KlTp8pvv/0mtWrVksTERImKinL7/bp160pXEgAAAAQ22PXq1atsewQAAED5CHYpKSn+KQkAAAAC28dOHT16VF5//XVzCbHDhw8XNMHu3r27bKUBAABA4Grsfv75Z+ncubNUqVJFduzYIUOHDjWjZBcsWCBpaWkyZ86c0pcGAAAAgauxGzlypAwePFi2bdsmsbGxBct79OghX3/9delLAgAAgMAGux9++EHuuuuuIssTEhJk3759ZSsNAAAAAhfsYmJiJCMjo8jy//znP1KjRo3SlwQAAACBDXY33HCDTJgwQXJzc819vVas9q179NFHpU+fPmUrDQAAAAIX7HSC4hMnTkjNmjXlr7/+kk6dOkmjRo3krLPOkn/961+lLwkAAAACOypWR8MuXbpUvvnmGzNCVkNeq1atzEhZAAAAWCjYOV122WXmBgAAAIsGO+1fdzpjx44tS3kAAAAQqGD30Ucfud3XQRR//PGHREZGynnnnUewAwAAsEqw++mnn4os0+lPdNLim266yVflAgAAQCCuFVtY5cqVZfz48TJmzBhfbA4AAADBCnbq2LFj5gYAAACLNMU+//zzbvcdDofs3btX3n77bbn22mt9WTYAAAD4M9g9++yzbvfDw8PNpcQGDRokycnJUhozZsyQZ555xlxrtkWLFvLCCy9Iu3btPK67YMECefLJJ2X79u1m4Ebjxo3lwQcflDvuuKNU+wYAIBgSR30mVhQT4ZCnPX9Fw4rBTkfA+tL8+fNl5MiRMnPmTGnfvr1Mnz5dunXrJlu3bjVXtyisevXqMnr0aGnSpIlER0fLwoULJSkpyayrjwMAAAhVPutjV1rTpk2ToUOHmnDWtGlTE/Di4uJk1qxZHte/8sorzejbCy64wEyvMnz4cLnooovMlTAAAABCmVc1dr179/Z6g9pU6q2cnBxZu3atWxOuNu3q5clWr159xsdr/76vvvrK1O5NnjzZ6/0CAACEbLDT68P6w8GDByUvL09q1arltlzvb9mypdjH6ejbhIQEyc7OloiICHnppZekS5cuHtfVdfTmOuee0v55eoP/OY8zxxsl6cNjRTHh/y13bnisWA7vz4Cz/HnOORMwJTnWXgU7bfrs3r276dNWHpx11lmy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q1cv+Dk8PFxGjRpVuj0DAAAg8MEuIyPD6w1yRQoAAIByHOyqVq1qRr6ejl5DVtfJy8vzVdkAAADg62DnvE4sAAAALB7sOnXq5P+SAAAAILDz2KmVK1fKgAEDzKXFdu/ebZa9/fbb8s0335StNAAAAAhcsPvwww+lW7duUqFCBVm3bp1kZ2eb5ceOHTOXGwMAAIBFgt0TTzwhM2fOlNdee83MYed06aWXmqAHAAAAiwS7rVu3mqtPFFalShVzWTEAAABYJNjVrl1btm/fXmS59q9r2LChr8oFAAAAfwe7oUOHmuvDfv/992beuj179si///1veeihh+See+6R0pgxY4YkJiZKbGystG/fXtasWVPsutoEfPnll0u1atXMrXPnzqddHwAAIFSU+JJiegmx/Px8ueaaayQrK8s0y8bExJhgd99995W4APPnz5eRI0eafnsa6qZPn24GZ2iTb82aNYusv3z5cunXr58ZkatBcPLkydK1a1fZvHmzJCQklHj/AAAAIVtjp7V0o0ePlsOHD8umTZvku+++kwMHDsjEiRPlr7/+KnEBpk2bZmoBk5KSpGnTpibgxcXFyaxZszyur7WD9957r7Rs2VKaNGkir7/+ugmaqampJd43AABASNfYOUVHR5sgpnTKEw1oTz/9tOzbt8/rbeTk5MjatWslOTm5YFl4eLhpXl29erVX29Baw9zcXKlevbrH32vZnFOyuF73Vh+jN6uJiXCI1cSE/7fMueGxYkkWPE+szornueXPdc7zgLP8ec45EzAlOdZeBzsNR+PGjZOlS5eaUPfII49Ir169ZPbs2aYGLyIiQh544IESFfTgwYPm2rK1atVyW673t2zZ4tU2Hn30Ualbt64Jg55MmjRJxo8fX2T5kiVLTM2g1TzdTixrafPnxZIWLQp2CUKOlc9zy57rnOcBZ/nzfOnSYBchZGRlZfk+2I0dO1ZeeeUVE6BWrVolt9xyi2k+1aZYra3T+xruAumpp56SefPmmX532t/OE60N1D58rjV29evXN/3yKleuLFbTbNwXYsW/7ia2yZcuG++XqPyTYjnJu4JdgpBjxfPc8uc653nAWf4879LFbT5b+I+ztdGnwe7999+XOXPmyA033GD61l100UVy6tQp2bBhg+l3Vxrx8fEmDKanp7st1/s6rcrpTJkyxQS7L7/80pSlODqwQ2+F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V61aJf369ZMhQ4bITz/9JL169TK3TZs2BbzsAAAA5UnQg920adNk6NChkpSUJE2bNpWZM2dKXFyczJo1y+P6zz33nHTv3l0efvhhueCCC2TixInSqlUrefHFFwNedgAAgPIkqMEuJydH1q5dK507d/5fgcLDzf3Vq1d7fIwud11faQ1fcesDAACEishg7vzgwYOSl5cntWrVcluu97ds2eLxMfv27fO4vi73JDs729ycjh07Zv4/fPiw5ObmitVEnsoUq4nMd0hWVr4cyomWqPx8sZxDh4JdgpBjxfPc8uc653nAcZ4HwSFrnufHjx83/zscjvId7AJh0qRJMn78+CLLGzRoEJTyhKr+YmGT4oNdAliIZc91znOUAOd58AJelSpVym+wi4+Pl4iICElPT3dbrvdr167t8TG6vCTrJycnm8EZTvn5+aa27uyzz5awsDCfPA+cXkZGhtSvX1927twplStXDnZxAL/hXEco4DwPPK2p01BXt27dM64b1GAXHR0trVu3ltTUVDOy1Rm89P6wYcM8PqZDhw7m9yNGjChYtnTpUrPck5iYGHNzVbVqVZ8+D3hHPwD4EEAo4FxHKOA8D6wz1dSVm6ZYrU0bNGiQtGnTRtq1ayfTp0+XzMxMM0pWDRw4UBISEkyTqho+fLh06tRJpk6dKj179pR58+bJjz/+KK+++mqQnwkAAEBwBT3Y9e3bVw4cOCBjx441AyBatmwpixcvLhggkZaWZkbKOnXs2FHeffddefzxx+Wxxx6Txo0by8cffyzNmjUL4rMAAAAIvjCHN0MsgDLQUcla46r9HQs3iwN2wrmOUMB5Xr4R7AAAAGwi6FeeAAAAgG8Q7AAAAGyCYAcAAGATBDsAAACbINgh4Hbt2iX/+Mc/gl0MAABsh1GxCLgNGzZIq1atJC8vL9hFAcpsz5498s0338j+/fvNlXNc3X///UErF+BL+nn95ptvmis/eTrXv/rqq6CVDeVsgmIAsCr9orvrrrvM5RELX39afybYwS70qk96vusVn/SCAFxrvfyixg4BR40d7EIvhH733XebiVpdr5AD2E18fLzMmTNHevToEeyi4Az4JAKAUsrKypLbbruNUAfb01rpRo0aBbsY8AI1dvC53r17n/b3R48elRUrVlBjB8t75JFHpHr16jJq1KhgFwXwq6lTp8rvv/8uL774Is2w5RzBDj6XlJTk1XqzZ8/2e1kAf9I/Tq677jr566+/pHnz5hIVFeX2+2nTpgWtbIAv3XTTTbJs2TLzh8yFF15Y5FxfsGBB0MoGdwyegM8R2BAq9ELoX3zxhZx//vnmfuHBE4BdVK1a1YQ7TzjXyxdq7ACglKpVqybPPvusDB48ONhFAfzenzQuLq7YP+a9bamB/9HjFwBKKSYmRi699NJgFwPwuxo1akivXr3krbfeksOHD7vNXzd69Oiglg3uCHYAUIa5vV544YVgFwPwu23btpnmWK2Zq127tpnLrnLlytKvXz8zsALlB33sAKCU1qxZY2osFi5cSIdy2NrcuXNl/vz5Znqfdu3amRq8Tz75xPQxzcnJCXbx4II+dgBQSqfrV6QdymfNmhXQ8gD+UqdOHdOXrnv37kUmnO/ataukp6cHrWxwR40dAJTSjBkzTtuhHLCLzMxM0wRbmI4IP3XqVFDKBM/oYwcApUSHcoSKPn36mP507733nqSlpcm+fftk5cqV5vy//PLLg108uCDYAUAp0aEcoUKvOKH9SPXcbtCggSQkJMhVV11lzvfXXnst2MWDC5piAaCU6FCOUFGxYkX54IMP5NChQ7J9+3Yz1Y8GvCpVqgS7aCiEwRMAUEp0KAdQ3tAUCwClRIdyAOUNwQ4ASokO5QDKG5piAaAMNXaDBg2Sjz76yG3+ut69e5upULTPHQAEEsEOAMqIDuUAyguCHQAAgE3Qxw4AAMAmCHYAAAA2QbADAACwCYIdAACATRDsAAAAbIJgBwAAYBMEOwAAAJsg2AEAAIg9/D8o9aeG4oowzwAAAABJRU5ErkJggg==",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "\n",
    "df.plot(kind='bar')\n",
    "plt.ylabel('Relative influence')\n",
    "plt.title('Parameter Influence on Δx and Δy')\n",
    "plt.grid(True)\n",
    "plt.tight_layout()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "d9132d06",
   "metadata": {},
   "outputs": [],
   "source": [
    "x0 = np.array([\n",
    "    np.mean(L_range),\n",
    "    np.mean(am_range),\n",
    "    np.mean(an_range)\n",
    "])\n",
    "\n",
    "eps = 1e-4\n",
    "\n",
    "def local_sensitivity(f):\n",
    "    S = np.zeros(3)\n",
    "    for i in range(3):\n",
    "        xp = x0.copy(); xm = x0.copy()\n",
    "        xp[i] += eps; xm[i] -= eps\n",
    "        S[i] = (f(*xp) - f(*xm)) / (2*eps)\n",
    "    return np.abs(S) / np.sum(np.abs(S))\n",
    "\n",
    "S_dx_local = local_sensitivity(dx)\n",
    "S_dy_local = local_sensitivity(dy)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": ".venv (3.13.7)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.13.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
